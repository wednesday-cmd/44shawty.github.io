/*
 * XenForo token_input.min.js
 * Copyright 2010-2017 XenForo Ltd.
 * Released under the XenForo License Agreement: https://xenforo.com/license-agreement
 */
!function(c,g,h,k){XF.TokenInput=XF.Element.newHandler({options:{tokens:[","],minLength:2,maxLength:0,maxTokens:0,acUrl:""},$container:null,$selection:null,$hiddenInput:null,init:function(){var a=this.$target,b=this.options,d=a.clone().insertAfter(a).prop("type","hidden").removeAttr("data-xf-init").removeAttr("id"),e={tags:!0,width:"100%",containerCssClass:"input",language:XF.TokenInput.Phrases,minimumInputLength:b.minLength,maximumInputLength:b.maxLength,maximumSelectionLength:b.maxTokens,selectOnClose:!0,
disabled:a.prop("disabled")};try{e.tokenSeparators=c.parseJSON(b.tokens)}catch(l){e.tokenSeparators=b.tokens}b.acUrl&&(e.ajax={delay:250,data:c.proxy(this,"prepareAjax"),transport:c.proxy(this,"getAjax"),processResults:c.proxy(this,"processAjax")},e.escapeMarkup=function(a){return a},e.sorter=c.proxy(this,"sortResults"),e.templateResult=c.proxy(this,"prepareResults"),e.templateSelection=c.proxy(this,"prepareSelection"));a.remove();var f=c('<select name="tokens_select" multiple="multiple"></select>').insertBefore(d).select2(e);
d.val()&&(b=d.val().split(",").map(c.trim),c.each(b,function(a,b){c("<option selected>").val(b).text(b).appendTo(f)}),f.trigger("change"));this.$hiddenInput=d;d=f.data("select2");this.$container=d.$container;this.$selection=d.$selection;d.on("results:message",function(a){this.dropdown._resizeDropdown();this.dropdown._positionDropdown()});a.attr("autofocus")&&(f.select2("open"),d.$selection.addClass("is-focused"));a=f.closest(".overlay-container");if(a.length)a.on("overlay:hiding",function(){f.select2("close")});
d.$container.on("focusin focusout",c.proxy(this,"inputFocusBlur"));f.on("change",c.proxy(this,"updateInput"))},prepareAjax:function(a){return{q:a.term}},getAjax:function(a,b,c){return XF.ajax("get",this.options.acUrl,a.data,b)},processAjax:function(a,b){return"object"!=typeof a?{}:a},sortResults:function(a){if(1>=a.length)return a;a.hasOwnProperty(0)&&(a[0].hasOwnProperty("q")||a.push(a.shift()));return a},prepareResults:function(a){a.styledText=a.text;if(a.q){var b=new RegExp("("+XF.regexQuote(a.q)+
")","i");a.styledText=XF.htmlspecialchars(a.styledText).replace(b,"<strong>$1</strong>")}else a.disabled||(a.styledText="<strong>"+XF.htmlspecialchars(a.styledText)+"</strong>");b=a.styledText;a.iconHtml&&(b=a.iconHtml+"&nbsp;"+b);return b},prepareSelection:function(a){return XF.htmlspecialchars(a.text)},inputFocusBlur:function(a){switch(a.type){case "focusout":this.$selection.removeClass("is-focused");break;default:this.$selection.addClass("is-focused")}},updateInput:function(a){a=c(a.target);var b=
this.$hiddenInput;a.val()?b.val(a.val().join(", ")):b.val("")}});XF.TokenInput.Phrases={errorLoading:function(){return XF.phrase("s2_error_loading")},inputTooLong:function(a){return XF.phrase("s2_input_too_long",{"{count}":a.input.length-a.maximum})},inputTooShort:function(a){return XF.phrase("s2_input_too_short",{"{count}":a.minimum-a.input.length})},loadingMore:function(){return XF.phrase("s2_loading_more")},maximumSelected:function(a){return XF.phrase("s2_maximum_selected",{"{count}":a.maximum})},
noResults:function(){return XF.phrase("s2_no_results")},searching:function(){return XF.phrase("s2_searching")}};XF.Element.register("token-input","XF.TokenInput")}(jQuery,window,document);
