/*
 * XenForo form.min.js
 * Copyright 2010-2017 XenForo Ltd.
 * Released under the XenForo License Agreement: https://xenforo.com/license-agreement
 */
var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(b,h,f){b instanceof String&&(b=String(b));for(var a=b.length,c=0;c<a;c++){var e=b[c];if(h.call(f,e,c,b))return{i:c,v:e}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,h,f){b!=Array.prototype&&b!=Object.prototype&&(b[h]=f.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,h,f,a){if(h){f=$jscomp.global;b=b.split(".");for(a=0;a<b.length-1;a++){var c=b[a];c in f||(f[c]={});f=f[c]}b=b[b.length-1];a=f[b];h=h(a);h!=a&&null!=h&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:h})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,f){return $jscomp.findInternal(this,b,f).v}},"es6","es3");$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var h=0;return $jscomp.iteratorPrototype(function(){return h<b.length?{done:!1,value:b[h++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.iteratorFromArray=function(b,h){$jscomp.initSymbolIterator();b instanceof String&&(b+="");var f=0,a={next:function(){if(f<b.length){var c=f++;return{value:h(c,b[c]),done:!1}}a.next=function(){return{done:!0,value:void 0}};return a.next()}};a[Symbol.iterator]=function(){return a};return a};
$jscomp.polyfill("Array.prototype.values",function(b){return b?b:function(){return $jscomp.iteratorFromArray(this,function(b,f){return f})}},"es6","es3");
!function(b,h,f){XF.SubmitClick=XF.Click.newHandler({eventNameSpace:"XFSubmitClick",options:{target:null,container:null,timeout:500,uncheckedValue:"0",disable:null},$input:null,$form:null,init:function(){var a=this.$target;if(a.is("label")&&(a=a.find("input:radio, input:checkbox"),!a.length))return;this.$input=a;a=a.closest("form");this.$form=a.length?a:null},click:function(a){var c=this.$input,b=this.$form,d=this.options.target,k=this.options.container;if(c)if(d){var g=this.options.uncheckedValue;
setTimeout(function(){var a={};k?a=c.closest(k).find("input, select, textarea").serializeArray():a[c.attr("name")]=c.prop("checked")?c.attr("value"):g;XF.ajax("POST",d,a)},0)}else b?((a=b.data("submit-click-timer"))&&clearTimeout(a),b.one("ajax-submit:complete",function(a,b,e){if(b.errors)c.prop("checked",c.prop("checked")?"":"checked");else if("checkbox"==c.attr("type")&&null!==c.closest("tr.dataList-row"))c.closest("tr.dataList-row")[c.prop("checked")?"removeClass":"addClass"]("dataList-row--disabled")}),
a=setTimeout(function(){b.submit()},this.options.timeout),b.data("submit-click-timer",a)):console.error("No target or form to submit on click")}});XF.AjaxSubmit=XF.Element.newHandler({options:{redirect:!0,skipOverlayRedirect:!1,forceFlashMessage:!1,resetComplete:!1,hideOverlay:!0,disableSubmit:".button, :submit, :reset, [data-disable-submit]",jsonName:null,jsonOptIn:null,replace:null},submitPending:!1,$submitButton:null,init:function(){var a=this.$target;a.is("form")?(a.on({submit:b.proxy(this,"submit"),
keyup:b.proxy(this,"cmdEnterKey"),"draft:beforesave":b.proxy(this,"draftCheck")}),a.on("click","input[type=submit], button:not([type]), button[type=submit]",b.proxy(this,"submitButtonClicked"))):console.error("%o is not a form",a[0])},submit:function(a){var c=this.$submitButton,e=this.$target;if("multipart/form-data"==e.attr("enctype")){if(this.options.jsonName){a.preventDefault();console.error("JSON serialized forms do not support the file upload-style enctype.");XF.alert(XF.phrase("oops_we_ran_into_some_problems_more_details_console"));
return}if(!h.FormData)return}if(!this.$submitButton||!this.$submitButton.data("prevent-ajax"))if(this.submitPending)a&&a.preventDefault();else{var d=b.Event("ajax-submit:before"),k={form:e,handler:this,method:e.attr("method")||"get",action:e.attr("action"),submitButton:c,preventSubmit:!1,successCallback:b.proxy(this,"submitResponse"),ajaxOptions:{skipDefault:!0}};e.trigger(d,k);if(k.preventSubmit)return!1;if(d.isDefaultPrevented())return!0;a&&a.preventDefault();var g=this;setTimeout(function(){g.submitPending=
!0;var a=XF.getDefaultFormData(e,c,g.options.jsonName,g.options.jsonOptIn);g.disableButtons();XF.ajax(k.method,k.action,a,k.successCallback,k.ajaxOptions).always(function(){g.$submitButton=null;setTimeout(function(){g.submitPending=!1;g.enableButtons()},300);d=b.Event("ajax-submit:always");e.trigger(d,e,g)})},0)}},disableButtons:function(){var a=this.options.disableSubmit;a&&this.$target.find(a).prop("disabled",!0)},enableButtons:function(){var a=this.options.disableSubmit;a&&this.$target.find(a).prop("disabled",
!1)},submitResponse:function(a,c,e){if("object"!=typeof a)XF.alert("Response was not JSON.");else{c=this.$target;e=this.$submitButton;var d=b.Event("ajax-submit:response");c.trigger(d,a,this);if(!d.isDefaultPrevented()){d=b.Event("ajax-submit:error");var k=!1,g=a.redirect&&this.options.redirect,f=c.closest(".overlay");f.length&&this.options.hideOverlay||(f=null);g&&this.options.skipOverlayRedirect&&f&&(g=!1);e&&e.attr("data-ajax-redirect")&&(g=e.data("ajax-redirect"));if(a.errorHtml)c.trigger(d,a,
this),d.isDefaultPrevented()||XF.setupHtmlInsert(a.errorHtml,function(a,c){c=c.h1||c.title||XF.phrase("oops_we_ran_into_some_problems");XF.overlayMessage(c,a)}),k=!0;else if(a.errors)c.trigger(d,a,this),d.isDefaultPrevented()||XF.alert(a.errors),k=!0;else if(a.exception)XF.alert(a.exception);else if("ok"==a.status&&a.message)g?this.options.forceFlashMessage?XF.flashMessage(a.message,1E3,function(){XF.redirect(a.redirect)}):XF.redirect(a.redirect):XF.flashMessage(a.message,3E3),f&&f.trigger("overlay:hide");
else if(a.html){var h=this;XF.setupHtmlInsert(a.html,function(a,c,b){if(h.options.replace&&h.doSubmitReplace(a,b))return!1;f&&f.trigger("overlay:hide");a=XF.getOverlayHtml({html:a,title:c.h1||c.title});XF.showOverlay(a)})}else"ok"==a.status&&(g&&XF.redirect(a.redirect),f&&f.trigger("overlay:hide"));a.errors&&d.isDefaultPrevented();d=b.Event("ajax-submit:complete");c.trigger(d,a,this);d.isDefaultPrevented()||this.options.resetComplete&&!k&&c[0].reset()}}},doSubmitReplace:function(a,c){var e=this.options.replace;
if(!e)return!1;var d=e.split(" with ");e=b.trim(d[0]);d=d[1]?b.trim(d[1]):e;if("self"==e||this.$target.is(e))var f=this.$target;else f=this.$target.find(e).first(),f.length||(f=b(e).first());if(!f.length)return console.error("Could not find old selector '"+e+"'"),!1;var g=a.is(d)?a:a.find(d).first();if(!g.length)return console.error("Could not find new selector '"+d+"'"),!1;g.hide().insertAfter(f);f.xfFadeUp(null,function(){f.remove();g.length&&(XF.activate(g),c(!1));g.xfFadeDown(null,XF.layoutChange)});
return!0},submitButtonClicked:function(a){this.$submitButton=b(a.currentTarget)},draftCheck:function(a){this.submitPending&&a.preventDefault()}});XF.AutoComplete=XF.Element.newHandler({loadTimer:null,loadVal:"",results:null,options:{single:!1,multiple:",",acurl:"",minLength:2,queryKey:"q",extraFields:"",extraParams:{},jsonContainer:"results",autosubmit:!1},init:function(){var a=this.$target;this.options.autosubmit&&(this.options.single=!0);this.options.acurl||(this.options.acurl=XF.getAutoCompleteUrl());
this.results=new XF.AutoCompleteResults({onInsert:b.proxy(this,"addValue")});a.attr("autocomplete","off").on({keydown:b.proxy(this,"keydown"),keyup:b.proxy(this,"keyup"),"blur click":b.proxy(this,"blur"),paste:function(){setTimeout(function(){a.trigger("keydown")},0)}});a.closest("form").submit(b.proxy(this,"hideResults"))},keydown:function(a){if(this.results.isVisible()){var c=this.results,b=function(){a.preventDefault();return!1};switch(a.which){case 40:return c.selectResult(1),b();case 38:return c.selectResult(-1),
b();case 27:return this.hide(),b();case 13:return c.insertSelectedResult(),b()}}},keyup:function(a){if(this.results.isVisible())switch(a.which){case 40:case 38:case 13:return}this.hideResults();this.loadTimer&&clearTimeout(this.loadTimer);this.loadTimer=setTimeout(b.proxy(this,"load"),200)},blur:function(a){clearTimeout(this.loadTimer);setTimeout(b.proxy(this,"hideResults"),250);this.xhr&&(this.xhr.abort(),this.xhr=!1)},load:function(){var a=this.loadVal,c=this.options.extraParams;this.loadTimer&&
clearTimeout(this.loadTimer);this.loadVal=this.getPartialValue();""==this.loadVal?this.hideResults():this.loadVal==a||this.loadVal.length<this.options.minLength||(c[this.options.queryKey]=this.loadVal,""!=this.options.extraFields&&b(this.options.extraFields).each(function(){c[this.name]=b(this).val()}),this.xhr&&this.xhr.abort(),this.xhr=XF.ajax("get",this.options.acurl,c,b.proxy(this,"showResults"),{global:!1,error:!1}))},hideResults:function(){this.results.hideResults()},showResults:function(a){this.xhr&&
(this.xhr=!1);this.options.jsonContainer&&a&&(a=a[this.options.jsonContainer]);this.results.showResults(this.getPartialValue(),a,this.$target)},addValue:function(a){if(this.options.single)this.$target.val(a);else{var c=this.getFullValues();""!=a&&(c.length&&(a=" "+a),c.push(a+this.options.multiple+" "));this.$target.val(c.join(this.options.multiple))}this.$target.trigger("auto-complete:insert",{inserted:a,current:this.$target.val()});this.options.autosubmit?this.$target.closest("form").submit():this.$target.autofocus()},
getFullValues:function(){var a=this.$target.val();if(""==a)return[];if(this.options.single)return[a];var c=a.lastIndexOf(this.options.multiple);if(-1==c)return[];a=a.substr(0,c);return a.split(this.options.multiple)},getPartialValue:function(){var a=this.$target.val();if(this.options.single)return b.trim(a);var c=a.lastIndexOf(this.options.multiple);return-1==c?b.trim(a):b.trim(a.substr(c+this.options.multiple.length))}});XF.UserMentioner=XF.Element.newHandler({options:{},$input:null,visible:!1,idleWait:200,
idleTimer:null,pendingMention:"",results:null,init:function(){this.$input=this.$target;var a=this;this.results=new XF.AutoCompleteResults({onInsert:function(c){a.insertMention(c)}});this.$input.on("keydown",b.proxy(this,"keydown"));this.$input.on("keyup",b.proxy(this,"keyup"));this.$input.on("blur click",b.proxy(this,"blur"));b(f).on("scroll",b.proxy(this,"blur"))},keydown:function(a){if(this.visible)switch(a.which){case 40:return this.results.selectResult(1),a.preventDefault(),!1;case 38:return this.results.selectResult(-1),
a.preventDefault(),!1;case 27:return this.hide(),a.preventDefault(),!1;case 13:if(this.visible)return a.preventDefault(),this.results.insertSelectedResult(),!1}},keyup:function(a){if(this.visible)switch(a.which){case 40:case 38:case 13:return}this.hide();this.idleTimer&&clearTimeout(this.idleTimer);this.idleTimer=setTimeout(b.proxy(this,"lookForMention"),this.idleWait)},blur:function(){this.visible&&setTimeout(b.proxy(this,"hide"),250)},lookForMention:function(){var a=this.getCurrentMentionInfo();
a?this.foundMention(a.name):this.hide()},getCurrentMentionInfo:function(){var a=this.$input;a.autofocus();var c=a.getSelection();if(!c||1>=c.end)return!1;a=a.val().substring(0,c.end);var b=a.lastIndexOf("@");if(-1==b)return null;if(0==b||a.substr(b-1,1).match(/(\s|[\](,]|--)/)){var d=a.substr(b+1);if(!d.match(/\s/)||10>=d.length)return{text:a,start:b,name:d.replace(new RegExp(String.fromCharCode(160),"g")," "),range:c}}return null},foundMention:function(a){this.pendingMention!=a&&(this.pendingMention=
a,2<=a.length&&"["!=a.substr(0,1)&&this.getPendingMentionOptions())},getPendingMentionOptions:function(){XF.ajax("GET",XF.getAutoCompleteUrl(),{q:this.pendingMention},b.proxy(this,"handlePendingMentionOptions"),{global:!1,error:!1})},handlePendingMentionOptions:function(a){var c=this.getCurrentMentionInfo();a.q&&c&&a.q==c.name&&(a.results?this.show(a.q,a.results):this.hide())},insertMention:function(a){this.hide();var c=this.$input;c.autofocus();var b=this.getCurrentMentionInfo();if(b){var d=b.range;
-1!=b.start+1&&(c.setSelection(b.start,d.end),c.replaceSelectedText("@"+a+" ","collapseToEnd"))}},show:function(a,c){this.getCurrentMentionInfo()&&(this.visible=!0,this.results.showResults(a,c,this.$input))},hide:function(){this.visible&&(this.visible=!1,this.results.hideResults())}});XF.AutoSubmit=XF.Element.newHandler({options:{hide:!0,progress:!0},init:function(){this.$target.submit();this.options.hide&&this.$target.find(":submit").hide();this.options.progress&&b(f).trigger("xf:action-start")}});
XF.ChangedFieldNotifier=XF.Element.newHandler({options:{hide:!0,progress:!0},init:function(){this.$target.find("input, select, textarea").each(function(){var a=b(this);a.data("orig-val",a.val());a.change(function(){a.toggleClass("is-changed",a.val()!=a.data("orig-val"))})})}});XF.CheckAll=XF.Element.newHandler({options:{container:"< form",match:"input:checkbox"},$container:null,updating:!1,init:function(){this.$container=XF.findRelativeIf(this.options.container,this.$target);var a=this;this.$container.on("click",
this.options.match,function(c){a.updating||b(c.target).is(a.$target)||a.updateState()});this.updateState();this.$target.click(b.proxy(this,"click"))},click:function(a){this.updating=!0;this.getCheckBoxes().prop("checked",a.target.checked).triggerHandler("click");this.updating=!1},updateState:function(){var a=this.getCheckBoxes(),c=0<a.length;a.each(function(){if(!b(this).prop("checked"))return c=!1});this.$target.prop("checked",c)},getCheckBoxes:function(){return this.$container.find(this.options.match).not(this.$target)}});
XF.DateInput=XF.Element.newHandler({options:{weekStart:0,minDate:null,maxDate:null,disableWeekends:!1,yearRange:null,showWeekNumber:!1,showDaysInNextAndPreviousMonths:!0},init:function(){var a=this.options.minDate,c=this.options.maxDate;if(a){var b=Date.parse(a.replace(/-/g,"/"));a=new Date(b)}c&&(b=Date.parse(c.replace(/-/g,"/")),c=new Date(b));var d=this,f=this.$target;b=f.val();a={onSelect:function(){var a=this._d,b=String(a.getDate()),c=String(a.getMonth()+1);a=String(a.getFullYear());d.$target.val(a+
"-"+(10>c?"0"+c:c)+"-"+(10>b?"0"+b:b))},onOpen:function(){f.prop("readonly")&&this.hide()},showTime:!1,firstDay:this.options.weekStart,minDate:a,maxDate:c,disableWeekends:this.options.disableWeekends,yearRange:this.options.yearRange,showWeekNumber:this.options.showWeekNumber,showDaysInNextAndPreviousMonths:this.options.showDaysInNextAndPreviousMonths,i18n:{previousMonth:"",nextMonth:"",weekdays:[0,1,2,3,4,5,6].map(function(a){return XF.phrase("day"+a)}),weekdaysShort:[0,1,2,3,4,5,6].map(function(a){return XF.phrase("dayShort"+
a)}),months:[0,1,2,3,4,5,6,7,8,9,10,11].map(function(a){return XF.phrase("month"+a)})},isRTL:XF.isRtl()};b&&(c=b.match(/^(\d{4})-(\d\d?)-(\d\d?)$/))&&(a.defaultDate=new Date(parseInt(c[1],10),parseInt(c[2],10)-1,parseInt(c[3])),a.setDefaultDate=!0);this.$target.pikaday(a);this.$target.val(b)}});XF.DescLoader=XF.Element.newHandler({options:{descUrl:null},$container:null,loading:!1,init:function(){if(this.options.descUrl){var a=this.$target.parent().find(".js-descTarget");a.length?(this.$container=
a,this.$target.on("change",b.proxy(this,"change"))):console.error("Target element must have a .js-descTarget sibling")}else console.error("Element must have a data-desc-url value")},change:function(){var a=this.$target.val();if(!a)this.$container.xfFadeUp(XF.config.speed.fast);else if(!this.loading){var c=this;XF.ajax("post",this.options.descUrl,{id:a},b.proxy(this,"onLoad")).always(function(){c.loading=!1})}},onLoad:function(a){var b=this.$container;a.description?this.$container.xfFadeUp(XF.config.speed.fast,
function(){b.html(a.description);b.xfFadeDown(XF.config.speed.normal)}):b.xfFadeUp(XF.config.speed.fast)}});XF.Disabler=XF.Element.newHandler({options:{container:"< li | ul, ol, dl",controls:"input, select, textarea, button, .js-attachmentUpload",hide:!1,optional:!1,invert:!1},$container:null,init:function(){this.$container=XF.findRelativeIf(this.options.container,this.$target);this.$container.length||this.options.optional||console.error("Could not find the disabler control container");var a=this.$target,
c=a.closest("form");if(c.length)c.on("reset",b.proxy(this,"formReset"));if(a.is(":radio")){var e=c,d=a.attr("name");c.length||(e=b(f.body));e.on("click",'input:radio[name="'+d+'"]',b.proxy(this,"click"))}else a.click(b.proxy(this,"click"));a.on("control:enabled control:disabled",b.proxy(this,"recalculateAfter"));this.recalculate(!0)},click:function(a,b){this.recalculateAfter(!1,b&&b.triggered)},formReset:function(a){this.recalculateAfter(!1,!0)},recalculateAfter:function(a,b){var c=this;setTimeout(function(){c.recalculate(a,
b)},0)},recalculate:function(a,c){var e=this.$container,d=this.$target,f=e.find(this.options.controls).not(d),g=a?0:XF.config.speed.fast,h=function(){c||e.find("input:not([type=hidden], [type=file]), textarea, select, button").not(d).first().autofocus()};d.is(":enabled")&&(d.is(":checked")&&!this.options.invert||this.options.invert&&!d.is(":checked"))?(e.prop("disabled",!1).removeClass("is-disabled"),f.prop("disabled",!1).removeClass("is-disabled").each(function(a,c){a=b(c);a.is("select.is-readonly")&&
a.prop("disabled",!0)}).trigger("control:enabled"),this.options.hide?(a?e.show():e.slideDown(g,function(){XF.layoutChange();h()}),XF.layoutChange()):a||h()):(this.options.hide&&(a?e.hide():e.slideUp(g,XF.layoutChange),XF.layoutChange()),e.prop("disabled",!0).addClass("is-disabled"),f.prop("disabled",!0).addClass("is-disabled").trigger("control:disabled").each(function(a,c){a=b(c);c=a.data("disabled");null!==c&&"undefined"!=typeof c&&a.val(c)}))}});XF.FieldAdder=XF.Element.newHandler({options:{incrementFormat:null,
remaining:-1},$clone:null,created:!1,init:function(){this.$target.find("input:not(:checkbox), select, textarea").val("");this.$clone=this.$target.clone();var a=this;this.$target.on("keypress change",function(c){b(c.target).prop("readonly")||(a.$target.off(c),a.create())})},create:function(){if(!this.created&&(this.created=!0,0!=this.options.remaining)){var a=this.options.incrementFormat;if(this.options.incrementFormat){var c=new RegExp("^"+XF.regexQuote(a).replace("\\{counter\\}","(\\d+)"));this.$clone.find("input, select, textarea").each(function(){var e=
b(this),d=e.attr("name");d=d.replace(c,function(b,c){return a.replace("{counter}",parseInt(c,10)+1)});e.attr("name",d)})}0<this.options.remaining&&this.$clone.attr("data-remaining",this.options.remaining-1);this.$clone.insertAfter(this.$target);XF.activate(this.$clone);XF.layoutChange()}}});XF.FormSubmitRow=XF.Element.newHandler({options:{container:".block-container",fixedChild:".formSubmitRow-main",stickyClass:"is-sticky",topOffset:100,minWindowHeight:281},$container:null,$fixedParent:null,$fixEl:null,
fixElHeight:0,winHeight:0,containerTop:0,containerBorderLeftWidth:0,topOffset:0,elBottom:0,state:"normal",windowTooSmall:!1,init:function(){if(XF.config.enableFormSubmitSticky){var a=this.$target,c=a.closest(this.options.container);c.length?(this.$container=c,this.topOffset=this.options.topOffset,this.$fixEl=a.find(this.options.fixedChild),b(h).on("scroll",b.proxy(this,"onScroll")).on("resize",b.proxy(this,"recalcAndUpdate")),c=XF.getFixedOffsetParent(a),c.is("html")||(this.$fixedParent=c,c.on("scroll",
b.proxy(this,"onScroll"))),b(f.body).on("xf:layout",b.proxy(this,"recalcAndUpdate")),a.height()||setTimeout(b.proxy(this,"recalcAndUpdate"),250),this.recalcAndUpdate()):console.error("Cannot float submit row, no container")}},recalc:function(){var a=this.$target;this.winHeight=b(h).height();this.elBottom=this.getTargetTop()+a.height();this.fixElHeight=this.$fixEl.height();this.containerTop=XF.getFixedOffset(this.$container).top;this.containerBorderLeftWidth=parseInt(this.$container.css("border-left-width"),
10)},recalcAndUpdate:function(){this.state="normal";this.resetTarget();this.recalc();this.update()},getTargetTop:function(){var a=this.$target.offset().top;return this.$fixedParent?a-this.$fixedParent.offset().top:a},getScrollTop:function(){return this.$fixedParent?this.$fixedParent.scrollTop():b(h).scrollTop()},update:function(){var a=XF.browser.ios||XF.browser.android?h.innerHeight:this.winHeight;if(a<this.options.minWindowHeight)"normal"!=this.state&&(this.resetTarget(),this.state="normal");else if(a=
this.getScrollTop()+a,a>=this.elBottom)"normal"!=this.state&&(this.resetTarget(),this.state="normal");else{var b=this.containerTop+this.topOffset+this.fixElHeight;a<=b?b>=this.elBottom||"absolute"==this.state||(a=this.$container.offset(),"stuck"==this.state?(b=this.$fixEl.parent(),"static"==b.css("position")&&(b=b.offsetParent())):b=this.$fixEl.offsetParent(),b=b.offset(),this.$fixEl.css({position:"absolute",top:a.top-b.top+this.topOffset,right:"auto",bottom:"auto",left:a.left-b.left+this.containerBorderLeftWidth,
width:this.$container.width()}),this.setTargetSticky(!0),this.state="absolute"):"stuck"!=this.state&&(a=this.$container.offset(),this.$fixEl.css({position:"",top:"",right:"",bottom:"",left:a.left+this.containerBorderLeftWidth,width:this.$container.width()}),this.setTargetSticky(!0),this.state="stuck")}},resetTarget:function(){this.$fixEl.css({position:"",top:"",right:"",bottom:"",left:"",width:""});this.setTargetSticky(!1)},setTargetSticky:function(a){this.$target.toggleClass("is-sticky",a).css("height",
this.$fixEl.height())},onScroll:function(){this.update()}});XF.GuestUsername=XF.Element.newHandler({init:function(){var a=this.$target;a.val(XF.LocalStorage.get("guestUsername"));a.on("keyup",b.proxy(this,"change"))},change:function(){var a=this.$target;a.val().length?XF.LocalStorage.set("guestUsername",a.val(),!0):XF.LocalStorage.remove("guestUsername")}});XF.MinLength=XF.Element.newHandler({options:{minLength:0,allowEmpty:!1,disableSubmit:!0,toggleTarget:null},met:null,$form:null,$toggleTarget:null,
init:function(){var a=this;this.$form=this.$target.closest("form");this.$toggleTarget=this.options.toggleTarget?XF.findRelativeIf(this.options.toggleTarget,this.$target):b([]);this.$target.on("change keypress keydown paste",function(){setTimeout(b.proxy(a,"checkLimits"),0)});this.checkLimits()},checkLimits:function(){var a=b.trim(this.$target.val()).length,c=this.options;a=a>=c.minLength||0==a&&c.allowEmpty;a!==this.met&&((this.met=a)?(c.disableSubmit&&this.$form.find(":submit").prop("disabled",!1).removeClass("is-disabled"),
this.$toggleTarget.hide()):(c.disableSubmit&&this.$form.find(":submit").prop("disabled",!0).addClass("is-disabled"),this.$toggleTarget.show()))}});XF.TextAreaHandler=XF.Element.newHandler({options:{autoSize:!0,keySubmit:!0,singleLine:!1},initialized:!1,init:function(){this.options.autoSize&&(this.$target[0].scrollHeight?this.setupAutoSize():(this.$target.one("focus",b.proxy(this,"setupDelayed")),this.$target.onWithin("toggle:shown overlay:shown tab:shown quick-edit:shown",b.proxy(this,"setupDelayed"))),
this.$target.on("autosize",b.proxy(this,"update")));if(this.options.keySubmit||this.options.singleLine)this.$target.on("keydown",b.proxy(this,"keySubmit"))},setupAutoSize:function(){this.initialized||(this.initialized=!0,autosize(this.$target),this.$target.on("autosize:resized",function(){XF.layoutChange()}))},setupDelayed:function(){if(this.initialized)this.update();else{var a=this,b=function(){a.setupAutoSize();XF.layoutChange()};this.$target[0].scrollHeight?b():setTimeout(b,100)}},update:function(){this.initialized?
autosize.update(this.$target[0]):this.setupDelayed()},keySubmit:function(a){if(13==a.which&&(this.options.singleLine||this.options.keySubmit&&(XF.isMac()?a.metaKey:a.ctrlKey)))return a.preventDefault(),this.$target.closest("form").submit(),!1}});XF.PermissionMatrix=XF.Element.newHandler({options:{inputSelector:'input[type="radio"]',parentSelector:"dl.formRow",classPrefix:"formRow--permissionType-",permissionType:"user"},values:["allow","unset","deny","content_allow","reset"],currentClass:null,init:function(){this.$parentRow=
this.$target.closest(this.options.parentSelector);this.$target.find(this.options.inputSelector).on("click",b.proxy(this,"update"));this.update()},update:function(){this.currentClass&&this.$parentRow.removeClass(this.currentClass);var a=this.$target.find(this.options.inputSelector+":checked").val();-1<b.inArray(a,this.values)&&(this.currentClass=this.options.classPrefix+this.options.permissionType+"-"+a,this.$parentRow.addClass(this.currentClass))}});XF.MultiCheck=XF.Click.newHandler({eventNameSpace:"XFMultiCheck",
options:{target:null,values:"allow,unset,deny"},$target:null,values:null,currentValue:null,init:function(){this.$target=b(this.options.target);this.values=this.options.values.split(",");var a=this.$target.filter(":checked").first().val();this.currentValue=0<b.inArray(a,this.values)?this.values[-1]:this.values[0]},click:function(a){var c=this.values[b.inArray(this.currentValue,this.values)+1];void 0===c&&(c=this.values[0]);this.$target.each(function(){b(this).val()==c&&b(this).prop("checked",!0).trigger("click")});
this.currentValue=c}});XF.NumberBox=XF.Element.newHandler({options:{textInput:".js-numberBoxTextInput"},$textInput:null,holdTimeout:null,holdInterval:null,init:function(){var a=this.$target,c=a.find(this.options.textInput);if(c.length){a.addClass("inputGroup--joined");var e=b("<button />").attr("type","button").attr("tabindex","-1").addClass("inputGroup-text").addClass("inputNumber-button").on("focus",b.proxy(this,"buttonFocus")).on("click",b.proxy(this,"buttonClick")).on("mousedown touchstart",b.proxy(this,
"buttonMouseDown")).on("mouseleave mouseup touchend",b.proxy(this,"buttonMouseUp")).on("touchend",function(a){a.preventDefault();b(this).click()});a=e.clone(!0).data("dir","up").addClass("inputNumber-button--up").insertAfter(c);e=e.clone(!0).data("dir","down").addClass("inputNumber-button--down").insertAfter(a);c.prop("disabled")&&(a.addClass("is-disabled").prop("disabled",!0),e.addClass("is-disabled").prop("disabled",!0));c.hasClass("input--numberNarrow")&&(a.addClass("inputNumber-button--smaller"),
e.addClass("inputNumber-button--smaller"));this.$textInput=c;if(!this.supportsStepFunctions())c.on("keydown",b.proxy(this,"stepFallback"))}else console.error("Cannot initialize, no text input.")},buttonFocus:function(a){return!1},buttonClick:function(a){this.step(b(a.target).data("dir"))},step:function(a){var b=this.$textInput,e="step"+a.charAt(0).toUpperCase()+a.slice(1);if(!b.prop("readonly"))if(this.supportsStepFunctions())b[0][e]();else this.stepFallback(a)},stepFallback:function(a){if(!this.$textInput.prop("readonly")){if("object"===
typeof a&&a.keyCode){var b=a;switch(b.keyCode){case 38:a="up";b.preventDefault();break;case 40:a="down";b.preventDefault();break;default:return}}b=this.$textInput;var e=b.val(),d="down"===a?-1:1;a=b.attr("min")||null;var f=b.attr("max")||null,g=b.attr("step")||1,h="any"==g;h&&(g=1);g=parseFloat(g);d=parseFloat(e)+g*d;if(Math.round(d)!==d){var l=0;h?l=e.split(".")[1].length||0:Math.floor(g)!==g&&(l=g.toString().split(".")[1].length||0);d=d.toFixed(l)}null!==a&&d<a&&(d=a);null!==f&&d>f&&(d=f);b.val(d)}},
buttonMouseDown:function(a){this.buttonMouseUp(a);this.holdTimeout=setTimeout(b.proxy(function(){this.holdInterval=setInterval(b.proxy(function(){this.step(b(a.target).data("dir"))},this),75)},this),500)},buttonMouseUp:function(a){clearTimeout(this.holdTimeout);clearInterval(this.holdInterval)},supportsStepFunctions:function(){var a=this.$textInput.clone();if(!a.prop("disabled")&&!a.prop("readonly")){if("function"===typeof a[0].stepUp)try{a[0].stepUp()}catch(c){return!1}else return!1;return!0}}});
XF.CheckboxSelectDisabler=XF.Element.newHandler({options:{select:null},$select:null,$checkboxes:null,init:function(){(this.$select=XF.findRelativeIf(this.options.select,this.$target))&&this.$select.length?(this.$checkboxes=this.$target.find(":checkbox").on("click",b.proxy(this,"update")),this.update()):console.warn("No select element found using %s",this.options.select)},update:function(){var a=this.$select;this.$checkboxes.each(function(){var b=a.find("option[value="+this.value+"]").prop("disabled",
!this.checked);!this.checked&&b.is(":selected")&&a.find("option:enabled").first().prop("selected",!0)})}});XF.focusNext=function(a){!a instanceof b&&(a=b(a));var c=b("a, button, :input, [tabindex]");a=c.index(a)+1;c.eq(a>=c.length?0:a).focus()};XF.Click.register("submit","XF.SubmitClick");XF.Click.register("multi-check","XF.MultiCheck");XF.Element.register("ajax-submit","XF.AjaxSubmit");XF.Element.register("auto-complete","XF.AutoComplete");XF.Element.register("user-mentioner","XF.UserMentioner");
XF.Element.register("auto-submit","XF.AutoSubmit");XF.Element.register("changed-field-notifier","XF.ChangedFieldNotifier");XF.Element.register("check-all","XF.CheckAll");XF.Element.register("date-input","XF.DateInput");XF.Element.register("desc-loader","XF.DescLoader");XF.Element.register("disabler","XF.Disabler");XF.Element.register("field-adder","XF.FieldAdder");XF.Element.register("form-submit-row","XF.FormSubmitRow");XF.Element.register("guest-username","XF.GuestUsername");XF.Element.register("min-length",
"XF.MinLength");XF.Element.register("textarea-handler","XF.TextAreaHandler");XF.Element.register("permission-matrix","XF.PermissionMatrix");XF.Element.register("number-box","XF.NumberBox");XF.Element.register("checkbox-select-disabler","XF.CheckboxSelectDisabler")}(jQuery,window,document);
